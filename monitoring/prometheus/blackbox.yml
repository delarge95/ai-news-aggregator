modules:
  http_2xx:
    prober: http
    timeout: 5s
    http:
      valid_http_versions: ["HTTP/1.1", "HTTP/2.0"]
      valid_status_codes: []
      method: GET
      headers:
        User-Agent: "AI News Blackbox Exporter"
      no_follow_redirects: false
      fail_if_ssl: false
      fail_if_not_ssl: false
      tls_config:
        insecure_skip_verify: false

  http_post_2xx:
    prober: http
    timeout: 5s
    http:
      method: POST
      headers:
        Content-Type: application/json
      body: '{}'

  tcp_connect:
    prober: tcp
    timeout: 5s

  pop3s_banner:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - expect: "^+OK"
        - send: "CAPA"
        - expect: "200-.*"

  ssh_banner:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - expect: "^SSH-2.0-"

  irc_banner:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - send: "NICK prober"
        - send: "USER prober prober prober :prober"
        - expect: "PING :([^ ]+)"
        - send: "PONG ${1}"
        - expect: "^:[^ ]+ 001"

  smtp_banner:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - expect: "^220[^ ]+"
        - send: "HELO prober"
        - expect: "^250[^ ]+"

  redis:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - expect: "PONG"

  postgres:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - send: \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00
        - expect: "^[Qq]"

  mysql:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - send: "\x00\x00\x00\x00"
        - expect: "mysql_native_password"

  mongodb:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - send: "\x41\x41\x41\x41"
        - expect: "OK"

  ldap_tls:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - expect: "dn:"
        - send: "b''"

  sip_options:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - send: "OPTIONS sip:user@127.0.0.1 SIP/2.0"
        - expect: "SIP/2.0 200"

  # Métricas específicas para AI News
  ai_news_api_health:
    prober: http
    timeout: 10s
    http:
      method: GET
      headers:
        Accept: application/json
      valid_status_codes: [200, 204]
      fail_if_not_matches_regexp:
        - '"status":\s*("ok"|"healthy")'

  ai_news_api_articles:
    prober: http
    timeout: 10s
    http:
      method: GET
      headers:
        Accept: application/json
      valid_status_codes: [200]
      fail_if_not_matches_regexp:
        - '"articles":\s*\['

  ai_news_api_search:
    prober: http
    timeout: 10s
    http:
      method: POST
      headers:
        Content-Type: application/json
      body: '{"query": "test", "limit": 1}'
      valid_status_codes: [200]
      fail_if_not_matches_regexp:
        - '"results":\s*\['

  ai_news_api_analytics:
    prober: http
    timeout: 10s
    http:
      method: GET
      headers:
        Accept: application/json
      valid_status_codes: [200]
      fail_if_not_matches_regexp:
        - '"analytics":\s*\{'

  ai_news_backend_service:
    prober: http
    timeout: 10s
    http:
      method: GET
      headers:
        Accept: application/json
        X-Health-Check: "blackbox"
      valid_status_codes: [200]
      fail_if_not_matches_regexp:
        - '"service":\s*"ai-news-backend"'
        - '"status":\s*"healthy"'

  ai_news_frontend_service:
    prober: http
    timeout: 15s
    http:
      method: GET
      fail_if_matches_regexp:
        - "404 Not Found"
        - "500 Internal Server Error"
        - "503 Service Unavailable"
      fail_if_not_matches_regexp:
        - "React"

  # Base de datos específica
  ai_news_postgres:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - send: "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        - expect: "^Z\x00\x00\x00\x00"

  ai_news_redis:
    prober: tcp
    timeout: 5s
    tcp:
      query_response:
        - send: "PING\r\n"
        - expect: "\\+PONG"

  # Monitoring stack específico
  prometheus_health:
    prober: http
    timeout: 5s
    http:
      method: GET
      valid_status_codes: [200]

  grafana_health:
    prober: http
    timeout: 5s
    http:
      method: GET
      headers:
        Accept: application/json
      valid_status_codes: [200]

  alertmanager_health:
    prober: http
    timeout: 5s
    http:
      method: GET
      valid_status_codes: [200]

  elasticsearch_health:
    prober: http
    timeout: 10s
    http:
      method: GET
      headers:
        Accept: application/json
      valid_status_codes: [200]
      fail_if_not_matches_regexp:
        - '"status":\s*"green"|"yellow"'

  kibana_health:
    prober: http
    timeout: 10s
    http:
      method: GET
      headers:
        Accept: application/json
      valid_status_codes: [200]